[
    {
        "difficulty": "Easy",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "Which user's mailbox was accessed during this suspicious email reading event?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": 1,
        "end_node": 4,
        "hop": 1,
        "hint": "1. Check table `OfficeActivity` with Operation == 'MailItemsAccessed', and AppId of Microsoft Graph API is '00000003-0000-0000-c000-000000000000'.\n2. Check for MailboxOwnerUPN."
    },
    {
        "difficulty": "Easy",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "What is the ID of the client application?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": 1,
        "end_node": 3,
        "hop": 1,
        "hint": "1. Check table `OfficeActivity` with Operation == 'MailItemsAccessed' and AppId of Microsoft Graph API is '00000003-0000-0000-c000-000000000000'.\n2. Look for the ClientAppId associated with these mail read events."
    },
    {
        "difficulty": "Medium",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "What is the IP address of the user that performed this email reading activity?",
        "answer": "72.43.121.43",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This client application authenticated from IP address: 72.43.121.43."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": 1,
        "end_node": 8,
        "hop": 2,
        "hint": "1. Check the `OfficeActivity` table to identify mail read events by Graph API using the provided AppId for Graph API ('00000003-0000-0000-c000-000000000000'). This will help identify the ClientAppId associated with the suspicious email reading.\n2. Use the `ClientAppId` to query the `AADServicePrincipalSignInLogs` table to find authentication events for the client application.\n3. From the `AADServicePrincipalSignInLogs`, extract the IP address associated with these authentication events."
    },
    {
        "difficulty": "Hard",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "Which technique did this attacker used to gain initial access to the tenant?",
        "answer": "password spray attack",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This ID logged in from IP address 72.43.121.43.",
            "3. Multiple users attempted to authenticate from this IP address, but only mvelazco@defenderatevet17.onmicrosoft.com succeeded. The attacker used password spray attack to gain access to the tenant."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs",
            "SigninLogs"
        ],
        "start_node": 1,
        "end_node": 10,
        "hop": 3,
        "human modified": true,
        "hint": "1. Check the `OfficeActivity` table to find the client app's `ClientAppId` of the suspicious email reading event.\n2. Use the `ClientAppId` to check the `AADServicePrincipalSignInLogs` to identify the IP address where the client app authenticated.\n3. Investigate the `SigninLogs` to check for other authentication events from the same IP address.\n4. Determine if multiple users are attempting to authenticate from the same IP address. Identify the patterns and any successful authentication logs to understand the technique used by the attacker.\n\n"
    },
    {
        "difficulty": "Easy",
        "context": "A suspicious client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf has been identified.",
        "question": "What is the IP address where this application authenticated from?",
        "answer": "72.43.121.43",
        "tables": [
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": 3,
        "end_node": 8,
        "hop": 1,
        "human modified": true,
        "hint": "1. Check `AADServicePrincipalSignInLogs` to identify the last time the client app with `ClientAppId` was authenticated.\n2. Investigate the event to find the IP address used during the authentication."
    },
    {
        "difficulty": "Hard",
        "context": "A suspicious client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf has been identified.",
        "question": "Which technique did this attacker used to gain initial access to the tenant?",
        "answer": "password spray attack",
        "solution": [
            "1. The client application authenticated from IP address: 72.43.121.43.",
            "2. Multiple users attempted to authenticate from this IP, but only mvelazco@defenderatevet17.onmicrosoft.com succeeded. This indicates that the attacker used a password spray attack to gain initial access to the tenant."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "SigninLogs"
        ],
        "start_node": 3,
        "end_node": 10,
        "hop": 2,
        "human modified": true,
        "hint": "1. Check `AADServicePrincipalSignInLogs` using the ClientAppId to find the IP address where the client application was authenticated.\n2. Use the identified IP address to check `SigninLogs` for other authentication events from the same IP address.\n3. Verify if multiple users are authenticating from the same IP address and investigate the successful authentication events."
    },
    {
        "difficulty": "Easy",
        "context": "A suspicious IP address has been identified: 72.43.121.43.",
        "question": "What is the username of the account that successfully authenticated from the same IP address?",
        "answer": "mvelazco@defenderatevet17.onmicrosoft.com",
        "tables": [
            "SigninLogs"
        ],
        "start_node": 8,
        "end_node": 10,
        "hop": 1,
        "human modified": true,
        "hint": "1. Check `SigninLogs` to identify all authentication events from the suspicious IP address 72.43.121.34.\n2. Look for the `UserPrincipalName` of the account that successfully authenticated from this IP address."
    },
    {
        "difficulty": "Medium",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "What is the Object ID associated with this suspicious client application?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This client application ID is associated with Object ID: 47dee0a2-d662-4664-acfa-a28bb62bdbc0."
        ],
        "tables": [
            "OfficeActivity",
            "SecurityExposureManagement"
        ],
        "start_node": 1,
        "end_node": 6,
        "hop": 2,
        "hint": "1. Check the `OfficeActivity` table for mail read events using the Graph API's ID (`00000003-0000-0000-c000-000000000000`).\n2. Identify the `ClientAppId` associated with the suspicious email reading event.\n3. Use the identified `ClientAppId` to check the `SecurityExposureManagement` table for more information about the client application, including the `ObjectId`."
    },
    {
        "difficulty": "Hard",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "New credentials were added to the application registration before it authenticated. What is the last time this application' credentials were modified?",
        "answer": "7/25/2024, 16:17:21.970600+00:00",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This client application ID is associated with Object ID: 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "3. Check AuditLogs for recent changes to this application registration, and find that new credentials were added to the application registration at 7/25/2024, 16:17:21.970600+00:00."
        ],
        "tables": [
            "OfficeActivity",
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": 1,
        "end_node": 12,
        "hop": 3,
        "human modified": true,
        "hint": "1. Check the `OfficeActivity` table for mail read events using the AppId of the Microsoft Graph API.\n2. Locate the ClientAppId from the mail read events.\n3. Use the `SecurityExposureManagement` table to find more information about the client app with the identified ClientAppId.\n4. With the ObjectId obtained, check the `AuditLogs` table for the latest actions such as modifications or updates to the application registration."
    },
    {
        "difficulty": "Easy",
        "context": "The client application ID was identified to be bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
        "question": "What is the Object ID associated with this client application?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "tables": [
            "SecurityExposureManagement"
        ],
        "start_node": 3,
        "end_node": 6,
        "hop": 1,
        "human modified": true,
        "hint": "1. Check the table `SecurityExposureManagement` to find more information about the client application with the ID 'bb77fe0b-52af-4f26-9bc7-19aa48854ebf'.\n2. Look for the associated ObjectId in the results."
    },
    {
        "difficulty": "Medium",
        "context": "The client application ID was identified to be bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
        "question": "New credentials were added to the application registration before it authenticated. What is the last time this application' credentials were modified?",
        "answer": "7/25/2024, 16:17:21.970600+00:00",
        "solution": [
            "1. This client application ID is associated with Object ID: 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "2. Check AuditLogs for recent changes to this application registration, and find that new credentials were added to the application registration at 7/25/2024, 16:17:21.970600+00:00."
        ],
        "tables": [
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": 3,
        "end_node": 12,
        "hop": 2,
        "human modified": true,
        "hint": "1. Check `SecurityExposureManagement` to find the object ID of the client application using the ClientAppId.\n2. With the object ID, check `AuditLogs` for the latest actions such as modifications or updates to the application registration."
    },
    {
        "difficulty": "Easy",
        "context": "The Object ID of the suspicious application was identified to be 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
        "question": "New credentials were added to the application registration before it authenticated. What is the last time this application' credentials were modified?",
        "answer": "7/25/2024, 16:17:21.970600+00:00",
        "tables": [
            "AuditLogs"
        ],
        "start_node": 6,
        "end_node": 12,
        "hop": 1,
        "human modified": true,
        "hint": "1. Check `AuditLogs` for the latest actions that have occurred to this application registration, focusing on modifications, updates, and credential changes."
    },
    {
        "difficulty": "Hard",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "What other suspicious activity was performed by the same client application?",
        "answer": "Enumerate users and applications using Microsoft Graph API",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This ID is logged in with IP address: 72.43.121.43.",
            "3. A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": 1,
        "end_node": 14,
        "hop": 3,
        "human modified": true,
        "hint": "1. Check `OfficeActivity` to investigate the mail read events using the Graph API.\n2. With the client application's ID found, refer to `AADServicePrincipalSignInLogs` to identify authentication events for the client app.\n3. Once the IP address is identified, check `MicrosoftGraphActivityLogs` to find other activities associated with the same IP address, focusing on Microsoft Graph API requests."
    },
    {
        "difficulty": "Medium",
        "context": "There is a suspicious email reading event by a client application with ID bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
        "question": "What other suspicious activity was performed by the same client application?",
        "answer": "Enumerate users and applications using Microsoft Graph API",
        "solution": [
            "1. The client application is logging in from IP address 72.43.121.43.",
            "2. A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": 3,
        "end_node": 14,
        "hop": 2,
        "human modified": true,
        "hint": "1. Check `AADServicePrincipalSignInLogs` to find the IP address where the client application with the given ClientAppId authenticated.\n2. Use the identified IP address and check `MicrosoftGraphActivityLogs` to investigate other activities originating from the same IP address, such as requests to users and applications.\n"
    },
    {
        "difficulty": "Easy",
        "context": "There is a suspicious email reading event with IP address 72.43.121.43.",
        "question": "what other activities are being observed from the same IP address?",
        "answer": "A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications.",
        "tables": [
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": 8,
        "end_node": 14,
        "hop": 1,
        "human modified": true,
        "hint": "1. Check `MicrosoftGraphActivityLogs` for activities with the IP address in question.\n2. Specifically, investigate requests to endpoints related to '/users' and '/applications' to see what additional activities are being performed from the same IP address."
    },
    {
        "difficulty": "Easy",
        "context": "There is a suspicious access to this email: mmelendez@DefenderATEVET17.onmicrosoft.com.",
        "question": "What is the App ID of the Microsoft service that was used to access this email box?",
        "answer": "00000003-0000-0000-c000-000000000000 or 47629505-c2b6-4a80-adb1-9b3a3d233b7b",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": 4,
        "end_node": 1,
        "hop": 1,
        "hint": "Check the `OfficeActivity` table for 'MailItemsAccessed' events with the MailboxOwnerUPN of the email in question"
    },
    {
        "difficulty": "Easy",
        "context": "There is a suspicious access to this email: mmelendez@DefenderATEVET17.onmicrosoft.com with a client application.",
        "question": "What is the client ID of the client application that accessed the mailbox?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": 4,
        "end_node": 3,
        "hop": 1,
        "hint": "1. Check `OfficeActivity` with the AppId of Microsoft Graph API for mail read events, filter the results by the MailboxOwnerUPN to identify the client application id."
    },
    {
        "difficulty": "Medium",
        "context": "There is a suspicious access to this email: mmelendez@DefenderATEVET17.onmicrosoft.com with a client application.",
        "question": "What is the IP address from which the client application accessed the mailbox?",
        "answer": "72.43.121.43",
        "solution": [
            "1. The email is accessed by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This ID is logged in with IP address: 72.43.121.43."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": 4,
        "end_node": 8,
        "hop": 2,
        "hint": "1. Check `OfficeActivity` table to identify the `ClientAppId` associated with the mail read events for the mailbox.\n2. With the `ClientAppId`, check `AADServicePrincipalSignInLogs` to find the IP address from which the client application authenticated."
    },
    {
        "difficulty": "Hard",
        "context": "There is a suspicious access to this email: mmelendez@DefenderATEVET17.onmicrosoft.com.",
        "question": "Which technique did this attacker used to gain initial access to the tenant?",
        "answer": "password spray attack",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This ID logged in from IP address 72.43.121.43.",
            "3. Multiple users attempted to authenticate from this IP address, but only mvelazco@defenderatevet17.onmicrosoft.com succeeded. The attacker used password spray attack to gain access to the tenant."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs",
            "SigninLogs"
        ],
        "start_node": 4,
        "end_node": 10,
        "hop": 3,
        "hint": "1. Check `OfficeActivity` for mail read events to find the `ClientAppId` used in the suspicious access.\n2. With the `ClientAppId`, check `AADServicePrincipalSignInLogs` to identify the IP address where the client app authenticated.\n3. Check `SigninLogs` to analyze authentication events from the same IP address to identify the attack technique used."
    },
    {
        "difficulty": "Medium",
        "context": "There is a suspicious access to this email: mmelendez@DefenderATEVET17.onmicrosoft.com with a client application.",
        "question": "What is the Object ID associated with the suspicious client application?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. The client's application ID is found from the email read events related to mmelendez@DefenderATEVET17.onmicrosoft.com.",
            "2. Further investigation into the client application's characteristics reveals its Object ID."
        ],
        "tables": [
            "OfficeActivity",
            "SecurityExposureManagement"
        ],
        "start_node": 4,
        "end_node": 6,
        "hop": 2,
        "hint": "1. Check `OfficeActivity` to find the client application's ClientAppId for the mail read events.\n2. With the ClientAppId from the previous step, check `SecurityExposureManagement` to find the ObjectId associated with the client application."
    },
    {
        "difficulty": "Hard",
        "context": "A client application was used to access the user's mailbox: mmelendez@DefenderATEVET17.onmicrosoft.com.",
        "question": "New credentials were added to the application registration before this email reading event. What is the last time this application' credentials were modified?",
        "answer": "7/25/2024, 16:17:21.970600+00:0000+00:00",
        "solution": [
            "1. The client's application ID is found from the email read events to be bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This client application ID is associated with Object ID: 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "3. Check AuditLogs for recent changes to this application registration, and find that new credentials were added to the application registration at 7/25/2024, 16:17:21.970600+00:00."
        ],
        "tables": [
            "OfficeActivity",
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": 4,
        "end_node": 12,
        "hop": 3,
        "human modified": true,
        "hint": "1. Check the `OfficeActivity` table for mail read events with the Graph API's AppId ('00000003-0000-0000-c000-000000000000').\n2. Identify the `ClientAppId` used for the mailbox access event.\n3. Check the `SecurityExposureManagement` table to find more information about the client app using the `ClientAppId`.\n4. Use the `ObjectId` from the previous step to query the `AuditLogs` table.\n5. Look for the latest actions, modifications, or updates related to the application registration, specifically focusing on the addition of new credentials."
    },
    {
        "difficulty": "Hard",
        "context": "A client application is used to access this email: mmelendez@DefenderATEVET17.onmicrosoft.com.",
        "question": "What other suspicious activity was performed by the same client application?",
        "answer": "Enumerate users and applications using Microsoft Graph API",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This ID is logged in with IP address: 72.43.121.43.",
            "3. A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": 4,
        "end_node": 14,
        "hop": 4,
        "hint": "1. Check `OfficeActivity` for mail read events using the Graph API's id ('00000003-0000-0000-c000-000000000000').\n2. Once you have identified the `ClientAppId`, check `AADServicePrincipalSignInLogs` to find where and when this client app was authenticated.\n3. Investigate `MicrosoftGraphActivityLogs` for other activities performed by the same client application, filtered by the identified IP address."
    },
    {
        "difficulty": "Easy",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "What is the IP address associated with the authentication events?",
        "answer": "72.43.121.43",
        "tables": [
            "SigninLogs"
        ],
        "start_node": 10,
        "end_node": 8,
        "hop": 1,
        "hint": "1. Check `SigninLogs` for authentication events involving multiple users, focusing on those that failed.\n2. Look for successful authentication events related to the user mvelazco@defenderatevet17.onmicrosoft.com in the same logs.\n3. Identify the common IP address associated with both failed and successful authentication events."
    },
    {
        "difficulty": "Hard",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "A client application is authenticatd from the IP address, what is the Client Application ID?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "solution": [
            "1. Identify the IP address to be 72.43.121.43",
            "2. Identify Client Application ID from OfficeActivity as 'bb77fe0b-52af-4f26-9bc7-19aa48854ebf'."
        ],
        "tables": [
            "SigninLogs",
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": 10,
        "end_node": 3,
        "hop": 3,
        "human modified": true,
        "hint": "1. Check `SigninLogs` to identify the IP address where multiple users authenticated but failed, and find the IP address of the successful authentication by mvelazco@defenderatevet17.onmicrosoft.com.\n2. With the identified IP address, check `AADServicePrincipalSignInLogs` to locate the Client Application ID that authenticated from the same IP address."
    },
    {
        "difficulty": "Hard",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "From the same IP address, a client application is using a Microsoft service to access the mailbox. What is the App ID of that service?",
        "answer": "00000003-0000-0000-c000-000000000000 or 47629505-c2b6-4a80-adb1-9b3a3d233b7b",
        "solution": [
            "1. Identify the IP address to be 72.43.121.43.",
            "2. Identify Client Application ID to be 'bb77fe0b-52af-4f26-9bc7-19aa48854ebf' from the same IP address.",
            "3. Check OfficeActivity to find the app ID is '00000003-0000-0000-c000-000000000000'."
        ],
        "tables": [
            "SigninLogs",
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": 10,
        "end_node": 1,
        "hop": 3,
        "human modified": true,
        "hint": "1. Check `SigninLogs` for other authentication events from the same IP address.\n2. Identify the `ClientAppId` of the client application from `AADServicePrincipalSignInLogs`.\n3. With the `ClientAppId`, check `OfficeActivity` for mail read events to find the AppID of the Microsoft service used to access the mailbox."
    },
    {
        "difficulty": "Easy",
        "context": "The IP address where a suspicious client application authenticated from was: 72.43.121.43",
        "question": "What is the Client Application ID associated with this suspicious activity?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "tables": [
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": 8,
        "end_node": 3,
        "hop": 1,
        "human modified": true,
        "hint": "1. Check the `AADServicePrincipalSignInLogs` table for sign-in events from the specified IP address (72.43.121.43).\n2. Look for entries that include information about the Client Application ID associated with these sign-in events."
    },
    {
        "difficulty": "Medium",
        "context": "The IP address where a suspicious client application authenticated from was: 72.43.121.43",
        "question": "From the same IP address, a client application is using a Microsoft service to access the mailbox. What is the App ID of that service?",
        "answer": "00000003-0000-0000-c000-000000000000 or 47629505-c2b6-4a80-adb1-9b3a3d233b7b",
        "solution": [
            "1. Identify Client Application ID to be 'bb77fe0b-52af-4f26-9bc7-19aa48854ebf' from the same IP address.",
            "2. Check OfficeActivity to find that the app ID is '00000003-0000-0000-c000-000000000000'."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": 8,
        "end_node": 1,
        "hop": 2,
        "human modified": true,
        "hint": "1. Check `AADServicePrincipalSignInLogs` to identify the client application by finding the `ClientAppId` which authenticated from the suspicious IP address.\n2. Check `OfficeActivity` using the identified `ClientAppId` to find mail read events.\n3. Finally, analyze the events to determine the App ID of the Microsoft service was used to access the mailbox from the given IP address."
    },
    {
        "difficulty": "Easy",
        "context": "A suspicious client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf has been identified to read emails with a Microsoft service.",
        "question": "What is the App ID of the service used?",
        "answer": "00000003-0000-0000-c000-000000000000 or 47629505-c2b6-4a80-adb1-9b3a3d233b7b",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": 3,
        "end_node": 1,
        "hop": 1,
        "human modified": true,
        "hint": "1. Check table `OfficeActivity` for mail read events with the specified ClientAppId"
    },
    {
        "difficulty": "Hard",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "There is a supsicious email reading event associated with this password spray attack. What is the email address of the mailbox that was accessed?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "solution": [
            "1. Check SigninLogs for the same IP address: 72.43.121.43.",
            "2. Identify ClientAppId: bb77fe0b-52af-4f26-9bc7-19aa48854ebf for this IP address.",
            "3. Check OfficeActivity for Graph API mail read events using ClientAppId.",
            "4. The user's mailbox accessed is mmelendez@DefenderATEVET17.onmicrosoft.com."
        ],
        "tables": [
            "SigninLogs",
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": 10,
        "end_node": 4,
        "hop": 3,
        "hint": "1. Check `SigninLogs` to identify an IP address where multiple users have authentication failures and one successful authentication.\n2. With the identified IP address, check `AADServicePrincipalSignInLogs` to find the `ClientAppId` of the client app that authenticated successfully.\n3. Once you have the `ClientAppId`, check `OfficeActivity` for mail read events using the Graph API's id.\n4. Look for `MailboxOwnerUPN` in the `OfficeActivity` table to identify the accessed mailbox's email address."
    },
    {
        "difficulty": "Medium",
        "context": "There is likely a passowrd spray attack from IP address 72.43.121.43.",
        "question": "From this IP address, whose mailbox was accessed?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "solution": [
            "1. Check AADServicePrincipalSignInLogs for ClientAppId: bb77fe0b-52af-4f26-9bc7-19aa48854ebf for IP address 72.43.121.43.",
            "2. Check OfficeActivity for Graph API mail read events using this ClientAppId.",
            "3. The user's mailbox accessed is mmelendez@DefenderATEVET17.onmicrosoft.com."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": 8,
        "end_node": 4,
        "hop": 2,
        "hint": "1. Check `AADServicePrincipalSignInLogs` to identify the `ClientAppId` of the client app authenticated from the IP address.\n2. With the `ClientAppId`, check `OfficeActivity` for mail read events using the Graph API.\n3. Look for the `MailboxOwnerUPN` in the results to determine whose mailbox was accessed."
    },
    {
        "difficulty": "Easy",
        "context": "The client application ID used in the investigation is bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
        "question": "Which user's mailbox was accessed using this client application ID?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": 3,
        "end_node": 4,
        "hop": 1,
        "hint": "1. Check table `OfficeActivity` with Operation == 'MailItemsAccessed' and filter using the specified ClientAppId.\n2. Look for the `MailboxOwnerUPN` to identify which user's mailbox was accessed."
    },
    {
        "difficulty": "Medium",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "From the same IP address, a client application was authenticated. What is the object ID associated with this client application?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. The authenticated account was associated with IP address 72.43.121.43.",
            "2. The IP address corresponds to the ClientAppId bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. The ClientAppId is linked to ObjectId 47dee0a2-d662-4664-acfa-a28bb62bdbc0."
        ],
        "tables": [
            "SigninLogs",
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement"
        ],
        "start_node": 10,
        "end_node": 6,
        "hop": 3,
        "human modified": true,
        "hint": "1. Check `SigninLogs` to identify the IP address where multiple users are authenticating but failing and find if any user successfully authenticated.\n2. Use the identified IP address to check `AADServicePrincipalSignInLogs` and find the `ClientAppId` of the client application that authenticated from that IP address.\n3. With the `ClientAppId`, check `SecurityExposureManagement` to find the associated object ID of the client application."
    },
    {
        "difficulty": "Hard",
        "context": "Multiple users are authenticating from the same IP address but failed. The same IP address is used to authenticate a client application.",
        "question": "New credentials were added to the application registration before this email reading event. What is the last time this application's credentials were modified?",
        "answer": "7/25/2024, 16:17:21.970600+00:00",
        "solution": [
            "1. The authenticated account was associated with IP address 72.43.121.43.",
            "2. The client's application ID is found from the email read events to be bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. This client application ID is associated with Object ID: 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "4. Check AuditLogs for recent changes to this application registration, and find that new credentials were added to the application registration at 7/25/2024, 16:17:21.970600+00:00."
        ],
        "tables": [
            "SigninLogs",
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": 10,
        "end_node": 12,
        "hop": 4,
        "human modified": true,
        "hint": "1. Check `SigninLogs` for authentication events from a specified IP address where multiple users failed to authenticate.\n2. Check `AADServicePrincipalSignInLogs` using the `ClientAppId` to determine when this client app last authenticated.\n3. Check `SecurityExposureManagement` using the `ClientAppId` to gather more information about the client app.\n4. Finally, examine `AuditLogs` for the latest modifications, updates, or credential changes associated with the application registration using the `ObjectId`."
    },
    {
        "difficulty": "Medium",
        "context": "The IP address where a suspicious client application authenticated from is 72.43.121.43.",
        "question": "What is the ObjectId of this client application?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. The IP address 72.43.121.43 corresponds to the ClientAppId bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. The ClientAppId is linked to ObjectId 47dee0a2-d662-4664-acfa-a28bb62bdbc0."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement"
        ],
        "start_node": 8,
        "end_node": 6,
        "hop": 2,
        "hint": "1. Check the `AADServicePrincipalSignInLogs` table to identify the `ClientAppId` of the client application that authenticated from IP address 72.43.121.43.\n2. With the `ClientAppId`, check the `SecurityExposureManagement` table to find more information, including the `ObjectId`, about the client application."
    },
    {
        "difficulty": "Hard",
        "context": "The IP address where a suspicious client application authenticated from is 72.43.121.43.",
        "question": "New credentials were added to the application registration before this email reading event. What is the last time this application's credentials were modified?",
        "answer": "7/25/2024, 16:17:21.970600+00:00",
        "solution": [
            "1. The IP address 72.43.121.43 corresponds to the ClientAppId bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. The ClientAppId is linked to ObjectId 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "3. Check AuditLogs for recent changes to this application registration, and find that new credentials were added to the application registration at 7/25/2024, 16:17:21.970600+00:00."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": 8,
        "end_node": 12,
        "hop": 3,
        "human modified": true,
        "hint": "1. Check `AADServicePrincipalSignInLogs` to identify when the client app with the specified `ClientAppId` was authenticated.\n2. Use the `ClientAppId` to check `SecurityExposureManagement` for more details about the client application.\n3. Obtain the `ObjectId` of the client application from `SecurityExposureManagement`.\n4. Use the `ObjectId` to review `AuditLogs` for any recent modifications or updates to the application registration, such as newly added credentials."
    },
    {
        "difficulty": "Medium",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successful with this IP address.",
        "question": "What other suspicious activities are being performed from the same IP address?",
        "answer": "A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications.",
        "solution": [
            "1. Multiple users are authenticating from the same IP address but failed. One account successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
            "2. Investigate IP address 72.43.121.43 for additional suspicious activities in SignInLogs.",
            "3. A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications."
        ],
        "tables": [
            "SigninLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": 10,
        "end_node": 14,
        "hop": 3,
        "human modified": true,
        "hint": "1. Check `SigninLogs` for authentication events using the field IPAddress.\n2. Identify the IP address showing failed authentication attempts.\n3. Check `MicrosoftGraphActivityLogs` for other activities involving the same IP address and specify requests to endpoints such as '/users' or '/applications'."
    },
    {
        "difficulty": "Medium",
        "context": "New credentials were added to a application registration right before it authenticated.",
        "question": "What is the ObjectId associated with the application that had changes made to its registration?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "tables": [
            "AuditLogs"
        ],
        "start_node": 12,
        "end_node": 6,
        "hop": 1,
        "hint": "1. Check `AuditLogs` for actions such as modifications or updates that have occurred to the application registration.\n2. Identify the `ObjectId` from the entries regarding the application registration changes."
    },
    {
        "difficulty": "Hard",
        "context": "New credentials were added to a application registration right before it authenticated.",
        "question": "What is the ClientAppId associated with the application where changes were made to its registration?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "solution": [
            "1. Identify the ObjectId associated with the application to be 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "2. Use the ObjectId to find the ClientAppId associated with this application: bb77fe0b-52af-4f26-9bc7-19aa48854ebf."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement"
        ],
        "start_node": 12,
        "end_node": 3,
        "hop": 2,
        "hint": "1. Check `AuditLogs` to identify the latest changes made to the application registration, focusing on modifications or updates tied to the provided ObjectId.\n2. Use `SecurityExposureManagement` to find further information about the client app using the identified ObjectId."
    },
    {
        "difficulty": "Hard",
        "context": "New credentials were added to the application registration right before it authenticated.",
        "question": "What suspicious activity was noted involving the application with new credentials added to its registration?",
        "answer": "Suspicious email reading event using Graph API through a previously unknown application registration.",
        "solution": [
            "1. Find the latest actions in the AuditLogs for the application registration.",
            "2. Identify the ObjectId associated with the application.",
            "3. Query the SecurityExposureManagement table to find more information about the client app with that ObjectId.",
            "4. Determine the ClientAppId for the application.",
            "5. Check the OfficeActivity table for mail read events involving the ClientAppId.",
            "6. Identify any suspicious activity related to the ClientAppId."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement",
            "OfficeActivity"
        ],
        "start_node": 12,
        "end_node": 1,
        "hop": 3,
        "Need Review": true,
        "hint": "1. Check `AuditLogs` for the latest actions involving the application registration with `ObjectId`.\n2. Check `OfficeActivity` to find email reading events using the Graph API.\n3. Check `SecurityExposureManagement` to gather more information about the client app with the provided `ClientAppId`."
    },
    {
        "difficulty": "Easy",
        "context": "ObjectId associated with the application where changes were made to its registration.",
        "question": "What is the ClientAppId associated with the application with ObjectId 47dee0a2-d662-4664-acfa-a28bb62bdbc0?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "tables": [
            "SecurityExposureManagement"
        ],
        "start_node": 6,
        "end_node": 3,
        "hop": 1,
        "hint": "1. Check `SecurityExposureManagement` to find more information about the application with ObjectId `47dee0a2-d662-4664-acfa-a28bb62bdbc0`.\n2. Identify the ClientAppId associated with the application from the results in `SecurityExposureManagement`."
    },
    {
        "difficulty": "Medium",
        "context": "New credentials were added to an application with ID bb77fe0b-52af-4f26-9bc7-19aa48854ebf right before it authenticated. And then it was used to read emails with a Microsoft service.",
        "question": "What is the App ID of that service?",
        "answer": "00000003-0000-0000-c000-000000000000 or 47629505-c2b6-4a80-adb1-9b3a3d233b7b",
        "solution": [
            "1. Identify Client Application ID to be 'bb77fe0b-52af-4f26-9bc7-19aa48854ebf' associated with the object ID.",
            "2. Check OfficeActivity to find that the app ID is '00000003-0000-0000-c000-000000000000'."
        ],
        "tables": [
            "SecurityExposureManagement",
            "OfficeActivity"
        ],
        "start_node": 6,
        "end_node": 1,
        "hop": 2,
        "hint": "1. Check `SecurityExposureManagement` to find more information about the client app with the given object ID.\n2. Check `OfficeActivity` for mail read events and find the App ID of the Microsoft service used."
    },
    {
        "difficulty": "Hard",
        "context": "We learn that certain changes were made against the application. Specifically, new credentials were added to the application registration right before it authenticated.",
        "question": "The same application was used to read emails. Who is the mailbox owner whose account was accessed during this incident?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "solution": [
            "1. Check `AuditLogs` for actions related to application registration changes to find the ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "3. Further investigation into this client's app reveals its Client ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "4. Mail reading activity linked to Graph API's app reveals the owner's mailbox UPN: mmelendez@DefenderATEVET17.onmicrosoft.com."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement",
            "OfficeActivity"
        ],
        "start_node": 12,
        "end_node": 4,
        "hop": 3,
        "hint": "1. Check `AuditLogs` to find the latest actions that have occurred to the application registration with the ObjectId provided.\n2. Using the `ObjectId` from `AuditLogs`, check the `SecurityExposureManagement` table for more information about the client app.\n3. Identify the `ClientAppId` associated with the application registration.\n4. With the `ClientAppId`, check the `OfficeActivity` table with Microsoft Graph API's id (00000003-0000-0000-c000-000000000000) to find mail read events.\n5. Check for the `MailboxOwnerUPN` to identify the mailbox owner whose account was accessed during this incident."
    },
    {
        "difficulty": "Medium",
        "context": "A client applicaton with object ID: 47dee0a2-d662-4664-acfa-a28bb62bdbc0 is found to perform a suspicious email reading event.",
        "question": "Who is the mailbox owner whose account was accessed during this incident?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "solution": [
            "1. Find the associated client app ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. Mail reading activity linked to Graph API's app reveals the mailbox owner UPN: mmelendez@DefenderATEVET17.onmicrosoft.com."
        ],
        "tables": [
            "SecurityExposureManagement",
            "OfficeActivity"
        ],
        "start_node": 6,
        "end_node": 4,
        "hop": 2,
        "hint": "1. Check the `SecurityExposureManagement` table to find the ClientAppId associated with the object ID.\n2. With the ClientAppId, check the `OfficeActivity` table for MailItemsAccessed events using Graph API's AppId.\n3. Look for the MailboxOwnerUPN in the retrieved events."
    },
    {
        "difficulty": "Medium",
        "context": "Certain changes were made against the application, including the addition of new credentials right before it authenticated.",
        "question": "what is the IP address involved in the suspicious activities detected in the application changes?",
        "answer": "72.43.121.43",
        "solution": [
            "1. Identify modifications or updates to the application registration from AuditLogs to find the client application's Object ID is 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "2. Identify the corresponding `ClientAppId` to be bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. Check authentication of the client application and find the IP address is 72.43.121.43."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": 12,
        "end_node": 8,
        "hop": 3,
        "hint": "1. Check `AuditLogs` to identify the latest actions, such as modifications or updates, to the application registration using its `ObjectId`.\n2. Check `SecurityExposureManagement` to find more information about the client app with the `ObjectId`.\n3. Check `AADServicePrincipalSignInLogs` to identify the last time this client app authenticated using the `ClientAppId`.\n4. Identify the IP address involved in these authentication events."
    },
    {
        "difficulty": "Hard",
        "context": "Certain changes were made against an application, including the addition of new credentials right before it authenticated.",
        "question": "Which technique did this attacker used to gain initial access to the tenant?",
        "answer": "password spray attack",
        "solution": [
            "1. Identify modifications or updates to the application registration from AuditLogs to find the client application's Object ID is 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "2. Identify the corresponding `ClientAppId` to be bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. The IP address for the authentication of the client app is 72.43.121.43.",
            "4. Multiple users attempted to authenticate from this IP address, but only mvelazco@defenderatevet17.onmicrosoft.com succeeded. The attacker used password spray attack to gain access to the tenant."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs",
            "SigninLogs"
        ],
        "start_node": 12,
        "end_node": 10,
        "hop": 4,
        "hint": "1. Check `AuditLogs` for the latest actions that have occurred to this application registration, including modifications and updates.\n2. Use `SecurityExposureManagement` to find more details about the client application using the identified ObjectId.\n3. Check `AADServicePrincipalSignInLogs` to see the last time the client application authenticated and to match it with the ClientAppId.\n4. Investigate `SigninLogs` to trace back authentication events from the same IP address.\n5. Identify if there were multiple failed authentication attempts from the same IP address, and relate the successful authentication attempt to the attacker's technique."
    },
    {
        "difficulty": "Medium",
        "context": "We learn that certain changes were made against the application with ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0. Specifically, new credentials were added to the application registration right before it authenticated.",
        "question": "what is the IP address involved in the authentication of this application?",
        "answer": "72.43.121.43",
        "solution": [
            "1. Find the `ClientAppId` to be bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. The IP address for that authentication is 72.43.121.43."
        ],
        "tables": [
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": 6,
        "end_node": 8,
        "hop": 2,
        "hint": "1. Check the `SecurityExposureManagement` table to find more information about the client app with ObjectId `47dee0a2-d662-4664-acfa-a28bb62bdbc0`.\n2. Use the information found to identify the `ClientAppId`.\n3. Check the `AADServicePrincipalSignInLogs` table to find authentication logs associated with the identified `ClientAppId`.\n4. From the sign-in logs, identify the IP address involved in the application's authentication."
    },
    {
        "difficulty": "Hard",
        "context": "We learn that certain changes were made against the application with ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0. Specifically, new credentials were added to the application registration right before it authenticated.",
        "question": "Which technique did this attacker used to gain initial access to the tenant?",
        "answer": "password spray attack",
        "solution": [
            "1. Identify the corresponding `ClientAppId` to be bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. The IP address for the authentication of the client app is 72.43.121.43.",
            "3. Multiple users attempted to authenticate from this IP address, but only mvelazco@defenderatevet17.onmicrosoft.com succeeded. The attacker used password spray attack to gain access to the tenant."
        ],
        "tables": [
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs",
            "SigninLogs"
        ],
        "start_node": 6,
        "end_node": 10,
        "hop": 3,
        "hint": "1. Check the `SecurityExposureManagement` table to gather detailed information about the client app using the provided `ObjectId`.\n2. Identify the `ClientAppId` from the results to proceed with the investigation.\n3. Use the `AADServicePrincipalSignInLogs` to determine the last authentication instance of the client app by correlating it with the `ClientAppId`.\n4. Investigate the `SigninLogs` table to explore other authentication events associated with the same IP address used by the client application.\n5. Summarize the logs to understand the attack pattern and identify which technique was used by the attacker to gain initial access to the tenant."
    },
    {
        "difficulty": "Hard",
        "context": "We learn that certain changes were made against a application. Specifically, new credentials were added to the application registration right before it authenticated.",
        "question": "What kind of suspicious activities were performed by the same IP address that the application authenticated from?",
        "answer": "A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications.",
        "solution": [
            "1. Check the audit logs to identify modifications to the application registration, and find the Object ID to be 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "2. Identify the ClientAppId associated with this Object ID to be bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. Check for the latest authentication events from the AADServicePrincipalSignInLogs, and identify the IP address to be 72.43.121.43.",
            "4. Investigate Microsoft Graph API requests to found that A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": 12,
        "end_node": 14,
        "hop": 4,
        "human modified": true,
        "hint": "1. Check `AuditLogs` to identify recent changes, such as the addition of new credentials to the application registration.\n2. With the modifications identified, use `AADServicePrincipalSignInLogs` to find the IP address from which the client app authenticated.\n3. Check `MicrosoftGraphActivityLogs` to find other activities performed from the same IP address and summarize the suspicious activities."
    },
    {
        "difficulty": "Hard",
        "context": "ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "question": "What kind of suspicious activities were performed by the same IP address associated with ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0?",
        "answer": "A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications.",
        "solution": [
            "1. Use the ObjectId to find more information about the client app from the SecurityExposureManagement table.",
            "2. Identify the ClientAppId associated with suspicious activities.",
            "3. Check for the latest authentication events from the AADServicePrincipalSignInLogs.",
            "4. Identify the IP address used for these authentication events.",
            "5. Investigate Microsoft Graph API requests from the same IP address."
        ],
        "tables": [
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": 6,
        "end_node": 14,
        "hop": 3,
        "hint": "1. Check the `SecurityExposureManagement` table to find more information about the client app with the given ObjectId.\n2. After identifying the `ClientAppId` from the `SecurityExposureManagement`, check the `AADServicePrincipalSignInLogs` table to find the IP address where the client app authenticated.\n3. Using the identified IP address, check the `MicrosoftGraphActivityLogs` table to identify other activities performed by the same IP address, focusing on Microsoft Graph API requests."
    },
    {
        "difficulty": "Medium",
        "context": "A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications.",
        "question": "What is the IP address of the user that is involved in the suspicious activity?",
        "answer": "72.43.121.43",
        "tables": [
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": 14,
        "end_node": 8,
        "hop": 1,
        "hint": "1. Check the `MicrosoftGraphActivityLogs` table to identify Microsoft Graph API requests related to both users and applications.\n2. Look for an `IPAddress` that is associated with both types of requests."
    },
    {
        "difficulty": "Hard",
        "context": "A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications.",
        "question": "What is the Client Application ID that authenticated from the suspicious IP address in use for Microsoft Graph API?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "solution": [
            "1. The IP address used for multiple requests to the Microsoft Graph API is identified: 72.43.121.43.",
            "2. Using the `AADServicePrincipalSignInLogs`, the ClientAppId of the suspicious activity is found: bb77fe0b-52af-4f26-9bc7-19aa48854ebf."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": 14,
        "end_node": 3,
        "hop": 2,
        "hint": "1. Check the `MicrosoftGraphActivityLogs` table to identify activities related to requests for both users and applications with the suspicious IP address.\n2. From the `MicrosoftGraphActivityLogs`, note down the IP address making these requests.\n3. Check the `AADServicePrincipalSignInLogs` table to identify the Client Application ID that authenticated from that IP address."
    },
    {
        "difficulty": "Hard",
        "context": "One IP address is using Microsoft Graph API to make different requests to retrieve information of both users and applications.",
        "question": "What other suspicious activity was performed by the same client application?",
        "answer": "Emails read with Graph API through a previously unknown application registration.",
        "solution": [
            "1. The IP address used for multiple requests to the Microsoft Graph API is identified: 72.43.121.43.",
            "2. Using the `AADServicePrincipalSignInLogs`, the ClientAppId of the suspicious activity is found: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. Check table `OfficeActivity` for activities involving mail reading: The suspicious activity is identified as an unknown application registration reading emails through Graph API."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": 14,
        "end_node": 1,
        "hop": 3,
        "hint": "1. Check `MicrosoftGraphActivityLogs` to identify the IP address of the client application making requests to the Microsoft Graph API.\n2. Use the identified IP address to check the `AADServicePrincipalSignInLogs` table to find the `ClientAppId` of the client application.\n3. Check the `OfficeActivity` table for mail read events involving the `ClientAppId` to identify the suspicious activity."
    },
    {
        "difficulty": "Medium",
        "context": "One IP address is using Microsoft Graph API to make different requests to retrieve information of both users and applications.",
        "question": "The client application is also used in a suspicious email reading event. What is the email address of the mailbox that was accessed?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "solution": [
            "1. Identify the IP address making requests: 72.43.121.43.",
            "2. Review the authentication events for this IP address and identify the client application ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. Use the identified ClientAppId to query mail read events and find the relevant mailbox owner's UPN: mmelendez@DefenderATEVET17.onmicrosoft.com."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": 14,
        "end_node": 4,
        "hop": 3,
        "hint": "1. Check the `MicrosoftGraphActivityLogs` table for activities with the specified IP address (`IPAddress`).\n2. With the identified `ClientAppId` from the activities, check the `AADServicePrincipalSignInLogs` to ensure the `ClientAppId` is the same as used in the suspicious email reading event.\n3. Check `OfficeActivity` with the Graph API's id for mail read events.\n4. Look for the `MailboxOwnerUPN` in the `OfficeActivity` table to identify the email address of the accessed mailbox."
    },
    {
        "difficulty": "Medium",
        "context": "One suspicious IP address is making requests to the Microsoft Graph API for both users and applications.",
        "question": "From the same IP address, which technique did this attacker used to gain initial access to the tenant?",
        "answer": "password spray attack",
        "solution": [
            "1. This ID logged in from IP address 72.43.121.43.",
            "2. Multiple users attempted to authenticate from this IP address, but only mvelazco@defenderatevet17.onmicrosoft.com succeeded. The attacker used password spray attack to gain access to the tenant."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "SigninLogs"
        ],
        "start_node": 14,
        "end_node": 10,
        "hop": 2,
        "hint": "1. Check `MicrosoftGraphActivityLogs` to find the details of the requests made by the suspicious IP address.\n2. Check `SigninLogs` to identify any authentication events (success or failure) associated with the same IP address.\n\n"
    },
    {
        "difficulty": "Medium",
        "context": "One IP address is making requests to the Microsoft Graph API for both users and applications. It was laso used to authenticate a client application.",
        "question": "What is the ObjectId associated with the application that had changes made to its registration?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. The IP address involved is 72.43.121.43, which is making these suspicious requests.",
            "2. This activity is associated with a client application ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
            "3. Further investigation reveals more information about this client application ID, including the ObjectId."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement"
        ],
        "start_node": 14,
        "end_node": 6,
        "hop": 3,
        "hint": "1. Check `MicrosoftGraphActivityLogs` to find API requests made by the identified IP address.\n2. Check `AADServicePrincipalSignInLogs` with the `ClientAppId` of the client application to confirm authentication events from the identified IP address.\n3. Use `ClientAppId` to investigate `SecurityExposureManagement` for details about the client application.\n4. Verify changes to the application registration by checking `AuditLogs` associated with the identified client application."
    },
    {
        "difficulty": "Hard",
        "context": "A single IP address is using the Microsoft Graph API to make various requests for retrieving information about both users and applications.",
        "question": "What specific changes were made to the application registration that used the suspicious IP?",
        "answer": "New credentials were added to the application registration right before it authenticated.",
        "solution": [
            "1. The IP address involved is 72.43.121.43, which is making these suspicious requests.",
            "2. This activity is associated with a client application ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. Further investigation reveals more information about this client application ID, including the ObjectId.",
            "4. Finally, checking the audit logs for modifications or updates right before the authentication leads to discovering that new credentials were added to the application registration."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": 14,
        "end_node": 12,
        "hop": 4,
        "hint": "1. Check `MicrosoftGraphActivityLogs` to find activities involving the suspicious IP address related to users and applications.\n2. Check `AADServicePrincipalSignInLogs` to identify when the client app with the `ClientAppId` last authenticated.\n3. Check `SecurityExposureManagement` to gather more information on the client app using the `ClientAppId`.\n4. Check `AuditLogs` for the latest actions related to the application registration, focusing on modifications and updates using the `ObjectId`."
    }
]