[
    {
        "difficulty": "Easy",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "Which user's mailbox was accessed during this suspicious email reading event?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": "1",
        "end_node": "4",
        "hop": "1"
    },
    {
        "difficulty": "Easy",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "What is the ID of the client application?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": "1",
        "end_node": "3",
        "hop": 1
    },
    {
        "difficulty": "Medium",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "What is the IP address of the user that performed this email reading activity?",
        "answer": "72.43.121.34",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This client application authenticated from IP address: 72.43.121.34."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": "1",
        "end_node": "8",
        "hop": 2
    },
    {
        "difficulty": "Hard",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "What is the username of the account that successfully authenticated from the suspicious IP address?",
        "answer": "mvelazco@defenderatevet17.onmicrosoft.com",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This ID logged in from IP address 72.43.121.34.",
            "3. Multiple users attempted to authenticate from this IP address, but only mvelazco@defenderatevet17.onmicrosoft.com succeeded."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs",
            "SigninLogs"
        ],
        "start_node": "1",
        "end_node": "10",
        "hop": 3
    },
    {
        "difficulty": "Medium",
        "context": "The client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf has been identified.",
        "question": "What is the IP address where this application authenticated from?",
        "answer": "72.43.121.34",
        "solution": [
            "1. The client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf authenticated from IP address: 72.43.121.34."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": "3",
        "end_node": "8",
        "hop": 1
    },
    {
        "difficulty": "Hard",
        "context": "The client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf has been identified.",
        "question": "What is the username of the account that successfully authenticated from the IP address where the client application authenticated?",
        "answer": "mvelazco@defenderatevet17.onmicrosoft.com",
        "solution": [
            "1. The client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf authenticated from IP address: 72.43.121.34.",
            "2. Multiple users attempted to authenticate from this IP, but only mvelazco@defenderatevet17.onmicrosoft.com succeeded."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "SigninLogs"
        ],
        "start_node": "3",
        "end_node": "10",
        "hop": 2
    },
    {
        "difficulty": "Medium",
        "context": "The IP address where the client application authenticated from has been identified: 72.43.121.34.",
        "question": "What is the username of the account that successfully authenticated from the same IP address?",
        "answer": "mvelazco@defenderatevet17.onmicrosoft.com",
        "solution": [
            "1. Multiple users attempted to authenticate from IP address: 72.43.121.34, but only mvelazco@defenderatevet17.onmicrosoft.com succeeded."
        ],
        "tables": [
            "SigninLogs"
        ],
        "start_node": "8",
        "end_node": "10",
        "hop": 1
    },
    {
        "difficulty": "Medium",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "What is the Object ID associated with this suspicious client application?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This client application ID is associated with Object ID: 47dee0a2-d662-4664-acfa-a28bb62bdbc0."
        ],
        "tables": [
            "OfficeActivity",
            "SecurityExposureManagement"
        ],
        "start_node": "1",
        "end_node": "6",
        "hop": "2"
    },
    {
        "difficulty": "Hard",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "What changes were made to the application registration right before the suspicious activity?",
        "answer": "New credentials were added",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This client application ID is associated with Object ID: 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "3. Check AuditLogs for recent changes to this application registration.",
            "4. New credentials were added to the application registration right before it authenticated."
        ],
        "tables": [
            "OfficeActivity",
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": "1",
        "end_node": "12",
        "hop": "3"
    },
    {
        "difficulty": "Easy",
        "context": "The client application ID was identified.",
        "question": "What is the Object ID associated with this client application?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "tables": [
            "SecurityExposureManagement"
        ],
        "start_node": "3",
        "end_node": "6",
        "hop": "1"
    },
    {
        "difficulty": "Medium",
        "context": "The client application ID was identified.",
        "question": "What changes were made to the application registration before the suspicious activity?",
        "answer": "New credentials were added",
        "solution": [
            "1. This client application ID is associated with Object ID: 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "2. Check AuditLogs for recent changes to this application registration.",
            "3. New credentials were added to the application registration right before it authenticated."
        ],
        "tables": [
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": "3",
        "end_node": "12",
        "hop": "2"
    },
    {
        "difficulty": "Medium",
        "context": "The Object ID of the suspicious application was identified.",
        "question": "What changes were made to the application registration before the suspicious activity?",
        "answer": "New credentials were added",
        "solution": [
            "1. Check AuditLogs for recent changes to this application registration: 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "2. New credentials were added to the application registration right before it authenticated."
        ],
        "tables": [
            "AuditLogs"
        ],
        "start_node": "6",
        "end_node": "12",
        "hop": "1"
    },
    {
        "difficulty": "Hard",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "what is the outcome of Graph API requests made from the same IP address as the suspicious email reading event?",
        "answer": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "solution": [
            "1. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This ID is logged in with IP address: 72.43.121.34.",
            "3. The same IP address is making requests to the Microsoft Graph API for both users and applications."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": "1",
        "end_node": "14",
        "hop": "3"
    },
    {
        "difficulty": "Medium",
        "context": "The client application with ID bb77fe0b-52af-4f26-9bc7-19aa48854ebf was involved.",
        "question": "From what IP address does the Graph API client application make requests?",
        "answer": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "solution": [
            "1. The client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf was making requests.",
            "2. Identify the same IP address making Graph API requests for both users and applications."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": "3",
        "end_node": "14",
        "hop": "2"
    },
    {
        "difficulty": "Easy",
        "context": "The IP address involved is 72.43.121.34.",
        "question": "what other activities are being observed from the same IP address?",
        "answer": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "tables": [
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": "8",
        "end_node": "14",
        "hop": "1"
    },
    {
        "difficulty": "Easy",
        "context": "The user's mailbox who was accessed: mmelendez@DefenderATEVET17.onmicrosoft.com.",
        "question": "Has the accessed mailbox experienced any suspicious email reading events?",
        "answer": "Yes, there is a suspicious email reading event where the emails are read with Graph API through a previously unknown application registration.",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": "4",
        "end_node": "1",
        "hop": "1"
    },
    {
        "difficulty": "Easy",
        "context": "The user's mailbox that was accessed is mmelendez@DefenderATEVET17.onmicrosoft.com.",
        "question": "What is the ID of the client application that accessed the mailbox?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": "4",
        "end_node": "3",
        "hop": "1"
    },
    {
        "difficulty": "Medium",
        "context": "The user's mailbox that was accessed is mmelendez@DefenderATEVET17.onmicrosoft.com.",
        "question": "What is the IP address from which the client application accessed the mailbox?",
        "answer": "72.43.121.34",
        "solution": [
            "1. The email is accessed by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This ID is logged in with IP address: 72.43.121.34."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": "4",
        "end_node": "8",
        "hop": "2"
    },
    {
        "difficulty": "Hard",
        "context": "The user's mailbox that was accessed is mmelendez@DefenderATEVET17.onmicrosoft.com.",
        "question": "Which user account successfully authenticated during the attack?",
        "answer": "mvelazco@defenderatevet17.onmicrosoft.com",
        "solution": [
            "1. The email is accessed by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. This ID is logged in with IP address: 72.43.121.34.",
            "3. Multiple users are authenticating from the same IP address but failed. There is one user account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs",
            "SigninLogs"
        ],
        "start_node": "4",
        "end_node": "10",
        "hop": "3"
    },
    {
        "difficulty": "Medium",
        "context": "The user's mailbox who was accessed: mmelendez@DefenderATEVET17.onmicrosoft.com.",
        "question": "What is the Object ID associated with the suspicious client application?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. The client's application ID is found from the email read events related to mmelendez@DefenderATEVET17.onmicrosoft.com.",
            "2. Further investigation into the client application's characteristics reveals its Object ID."
        ],
        "tables": [
            "OfficeActivity",
            "SecurityExposureManagement"
        ],
        "start_node": "4",
        "end_node": "6",
        "hop": "2"
    },
    {
        "difficulty": "Hard",
        "context": "The user's mailbox who was accessed: mmelendez@DefenderATEVET17.onmicrosoft.com.",
        "question": "What significant change was observed in the application registration before it authenticated?",
        "answer": "New credentials were added.",
        "solution": [
            "1. The client's application ID is found from the email read events related to mmelendez@DefenderATEVET17.onmicrosoft.com.",
            "2. Investigation into further details about the client application reveals its Object ID.",
            "3. AuditLogs shows the latest actions that occurred to the application registration, identifying that new credentials were added before authentication."
        ],
        "tables": [
            "OfficeActivity",
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": "4",
        "end_node": "12",
        "hop": "3"
    },
    {
        "difficulty": "Hard",
        "context": "MailboxOwnerUPN: mmelendez@DefenderATEVET17.onmicrosoft.com. The user's mailbox who was accessed.",
        "question": "What is making requests to the Microsoft Graph API?",
        "answer": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "solution": [
            "1. The mailbox owned by mmelendez@DefenderATEVET17.onmicrosoft.com was accessed.",
            "2. The email is read by client application with ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. This client app ID authenticated from IP address 72.43.121.34.",
            "4. Investigate other activities from the same IP address.",
            "5. The same IP address is making requests to the Microsoft Graph API for both users and applications."
        ],
        "tables": [
            "OfficeActivity",
            "AADServicePrincipalSignInLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": "4",
        "end_node": "14",
        "hop": "4",
        "Need Review": true
    },
    {
        "difficulty": "Medium",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "What is the IP address associated with the authentication events?",
        "answer": "72.43.121.34",
        "solution": [
            "1. Note the successful authentication account: mvelazco@defenderatevet17.onmicrosoft.com.",
            "2. This authentication attempts can be traced back to the IP address: 72.43.121.34."
        ],
        "tables": [
            "SigninLogs"
        ],
        "start_node": "10",
        "end_node": "8",
        "hop": "1"
    },
    {
        "difficulty": "Hard",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "What is the Client Application ID involved in the suspicious email reading activity?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "solution": [
            "1. Trace the IP address 72.43.121.34 to find related Client Application ID.",
            "2. Identify Client Application ID from OfficeActivity as 'bb77fe0b-52af-4f26-9bc7-19aa48854ebf'."
        ],
        "tables": [
            "SigninLogs",
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": "10",
        "end_node": "3",
        "hop": "3"
    },
    {
        "difficulty": "Hard",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "What suspicious email reading event was performed using the Graph API?",
        "answer": "Unknown application registration through Graph API",
        "solution": [
            "1. Identify the Client Application ID connected to the IP address 72.43.121.34.",
            "2. Check the OfficeActivity for events performed by this Client Application ID."
        ],
        "tables": [
            "SigninLogs",
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": "10",
        "end_node": "1",
        "hop": "3"
    },
    {
        "difficulty": "Medium",
        "context": "The IP address where the service principal authenticated from was: 72.43.121.34",
        "question": "What is the Client Application ID associated with this suspicious activity?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "solution": [
            "1. Identify Client Application ID from AADServicePrincipalSignInLogs for activity from IP address 72.43.121.34."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": "8",
        "end_node": "3",
        "hop": "1"
    },
    {
        "difficulty": "Medium",
        "context": "The IP address where the service principal authenticated from was: 72.43.121.34",
        "question": "What suspicious email reading event was performed using the Graph API?",
        "answer": "Unknown application registration through Graph API",
        "solution": [
            "1. Identify Client Application ID from AADServicePrincipalSignInLogs for activity from IP address 72.43.121.34.",
            "2. Check the OfficeActivity for events performed by this Client Application ID."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": "8",
        "end_node": "1",
        "hop": "2"
    },
    {
        "difficulty": "Easy",
        "context": "There is a suspicious email reading event, where the emails are read with Graph API through a previously unknown application registration.",
        "question": "What is the ID of the client application?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": "3",
        "end_node": "1",
        "hop": "1"
    },
    {
        "difficulty": "Hard",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "From the multiple authentication attempts, which user's mailbox was accessed?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "solution": [
            "1. Multiple users are authenticating from the same IP address but failed. One account successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
            "2. Check SigninLogs for the same IP address: 72.43.121.34.",
            "3. Identify ClientAppId: bb77fe0b-52af-4f26-9bc7-19aa48854ebf for this IP address.",
            "4. Check OfficeActivity for Graph API mail read events using ClientAppId.",
            "5. The user's mailbox accessed is mmelendez@DefenderATEVET17.onmicrosoft.com."
        ],
        "tables": [
            "SigninLogs",
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": "10",
        "end_node": "4",
        "hop": 3
    },
    {
        "difficulty": "Medium",
        "context": "The IP address where the service principal authenticated from is 72.43.121.34.",
        "question": "From this IP address, whose mailbox was accessed?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "solution": [
            "1. Check AADServicePrincipalSignInLogs for ClientAppId: bb77fe0b-52af-4f26-9bc7-19aa48854ebf for IP address 72.43.121.34.",
            "2. Check OfficeActivity for Graph API mail read events using this ClientAppId.",
            "3. The user's mailbox accessed is mmelendez@DefenderATEVET17.onmicrosoft.com."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": "8",
        "end_node": "4",
        "hop": 2
    },
    {
        "difficulty": "Easy",
        "context": "The client application ID used in the investigation is bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
        "question": "Which user's mailbox was accessed using this client application ID?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "tables": [
            "OfficeActivity"
        ],
        "start_node": "3",
        "end_node": "4",
        "hop": 1
    },
    {
        "difficulty": "Hard",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": " what is the ObjectId associated with the suspicious activity?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. The authenticated account was associated with IP address 72.43.121.34.",
            "2. The IP address corresponds to the ClientAppId bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. The ClientAppId is linked to ObjectId 47dee0a2-d662-4664-acfa-a28bb62bdbc0."
        ],
        "tables": [
            "SigninLogs",
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement"
        ],
        "start_node": "10",
        "end_node": "6",
        "hop": "4"
    },
    {
        "difficulty": "Hard",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "Were there any changes made to the application registration right before it authenticated?",
        "answer": "New credentials were added",
        "solution": [
            "1. The authenticated account was associated with IP address 72.43.121.34.",
            "2. The IP address corresponds to the ClientAppId bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. The ClientAppId is linked to ObjectId 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "4. Check AuditLogs for the latest actions that have occurred to this application registration and find that new credentials were added."
        ],
        "tables": [
            "SigninLogs",
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": "10",
        "end_node": "12",
        "hop": "5"
    },
    {
        "difficulty": "Medium",
        "context": "The IP address where the service principal authenticated from is 72.43.121.34.",
        "question": "What is the ObjectId of the associated entity with suspicious activity?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. The IP address 72.43.121.34 corresponds to the ClientAppId bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. The ClientAppId is linked to ObjectId 47dee0a2-d662-4664-acfa-a28bb62bdbc0."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement"
        ],
        "start_node": "8",
        "end_node": "6",
        "hop": "2"
    },
    {
        "difficulty": "Hard",
        "context": "The IP address where the service principal authenticated from is 72.43.121.34.",
        "question": "Were there any changes made to the application right before it authenticated?",
        "answer": "New credentials were added",
        "solution": [
            "1. The IP address 72.43.121.34 corresponds to the ClientAppId bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "2. The ClientAppId is linked to ObjectId 47dee0a2-d662-4664-acfa-a28bb62bdbc0.",
            "3. Check AuditLogs for the latest actions that have occurred to this application registration and find that new credentials were added."
        ],
        "tables": [
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": "8",
        "end_node": "12",
        "hop": "3"
    },
    {
        "difficulty": "Medium",
        "context": "Multiple users are authenticating from the same IP address but failed. There is one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
        "question": "What other suspicious activities are being performed from the same IP address?",
        "answer": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "solution": [
            "1. Multiple users are authenticating from the same IP address but failed. One account successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com.",
            "2. Investigate IP address 72.43.121.34 for additional suspicious activities in SignInLogs.",
            "3. Search for associated Microsoft Graph API requests from the same IP address to identify more suspicious behavior."
        ],
        "tables": [
            "SigninLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": "10",
        "end_node": "14",
        "hop": "3",
        "Need Review": true
    },
    {
        "difficulty": "Medium",
        "context": "New credentials were added to the application registration right before it authenticated.",
        "question": "What is the ObjectId associated with the application that had changes made to its registration?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. Find the latest actions in the AuditLogs for the application registration.",
            "2. Identify the ObjectId associated with the application where new credentials were added."
        ],
        "tables": [
            "AuditLogs"
        ],
        "start_node": "12",
        "end_node": "6",
        "hop": "1"
    },
    {
        "difficulty": "Hard",
        "context": "New credentials were added to the application registration right before it authenticated.",
        "question": "What is the ClientAppId associated with the application where changes were made to its registration?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "solution": [
            "1. Find the latest actions in the AuditLogs for the application registration.",
            "2. Identify the ObjectId associated with the application.",
            "3. Query the SecurityExposureManagement table to find more information about the client app with that ObjectId.",
            "4. Determine the ClientAppId for the application."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement"
        ],
        "start_node": "12",
        "end_node": "3",
        "hop": "2"
    },
    {
        "difficulty": "Hard",
        "context": "New credentials were added to the application registration right before it authenticated.",
        "question": "What suspicious activity was noted involving the application with new credentials added to its registration?",
        "answer": "Suspicious email reading event using Graph API through a previously unknown application registration.",
        "solution": [
            "1. Find the latest actions in the AuditLogs for the application registration.",
            "2. Identify the ObjectId associated with the application.",
            "3. Query the SecurityExposureManagement table to find more information about the client app with that ObjectId.",
            "4. Determine the ClientAppId for the application.",
            "5. Check the OfficeActivity table for mail read events involving the ClientAppId.",
            "6. Identify any suspicious activity related to the ClientAppId."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement",
            "OfficeActivity"
        ],
        "start_node": "12",
        "end_node": "1",
        "hop": "3",
        "Need Review": true
    },
    {
        "difficulty": "Easy",
        "context": "ObjectId associated with the application where changes were made to its registration.",
        "question": "What is the ClientAppId associated with the application with ObjectId 47dee0a2-d662-4664-acfa-a28bb62bdbc0?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "solution": [
            "1. Query the SecurityExposureManagement table to find more information about the client app with that ObjectId.",
            "2. Identify the ClientAppId associated with this application."
        ],
        "tables": [
            "SecurityExposureManagement"
        ],
        "start_node": "6",
        "end_node": "3",
        "hop": "1"
    },
    {
        "difficulty": "Medium",
        "context": "ObjectId associated with the application where changes were made to its registration.",
        "question": "What suspicious activity was noted involving the ClientAppId bb77fe0b-52af-4f26-9bc7-19aa48854ebf?",
        "answer": "Suspicious email reading event using Graph API through a previously unknown application registration.",
        "solution": [
            "1. Query the OfficeActivity table for mail read events involving the ClientAppId.",
            "2. Identify any suspicious activity related to the ClientAppId."
        ],
        "tables": [
            "OfficeActivity"
        ],
        "start_node": "6",
        "end_node": "1",
        "hop": "2"
    },
    {
        "difficulty": "Hard",
        "context": "We learn that certain changes were made against the application. Specifically, new credentials were added to the application registration right before it authenticated.",
        "question": "Who is the mailbox owner whose account was accessed during this incident?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "solution": [
            "1. Check `AuditLogs` for actions related to application registration changes.",
            "2. An object with ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0 is found.",
            "3. Further investigation into this client's app reveals its ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "4. Mail reading activity linked to Graph API's app reveals the owner's mailbox UPN: mmelendez@DefenderATEVET17.onmicrosoft.com."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement",
            "OfficeActivity"
        ],
        "start_node": "12",
        "end_node": "4",
        "hop": "3"
    },
    {
        "difficulty": "Medium",
        "context": "ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "question": "Who is the mailbox owner whose account was accessed during this incident?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "solution": [
            "1. Find the client app using ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0 in the `SecurityExposureManagement` table.",
            "2. Client's app has ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. Mail reading activity linked to Graph API's app reveals the mailbox owner UPN: mmelendez@DefenderATEVET17.onmicrosoft.com."
        ],
        "tables": [
            "SecurityExposureManagement",
            "OfficeActivity"
        ],
        "start_node": "6",
        "end_node": "4",
        "hop": "2"
    },
    {
        "difficulty": "Medium",
        "context": "Certain changes were made against the application, including the addition of new credentials right before it authenticated.",
        "question": "what is the IP address involved in the suspicious activities detected in the application changes?",
        "answer": "72.43.121.34",
        "solution": [
            "1. Identify modifications or updates to the application registration from AuditLogs.",
            "2. The final `ObjectId` is 47dee0a2-d662-4664-acfa-a28bb62bdbc0, which corresponds to the client application ID we are investigating.",
            "3. Find this `ClientAppId` in SecurityExposureManagement.",
            "4. The `ClientAppId` is bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "5. Check the AADServicePrincipalSignInLogs for the last authentication of this `ClientAppId`.",
            "6. The IP address for that authentication is 72.43.121.34."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": "12",
        "end_node": "8",
        "hop": "3"
    },
    {
        "difficulty": "Hard",
        "context": "Certain changes were made against the application, including the addition of new credentials right before it authenticated.",
        "question": "what is the email address of the user that successfully authenticated after the suspicious activities related to the application changes?",
        "answer": "mvelazco@defenderatevet17.onmicrosoft.com",
        "solution": [
            "1. Identify modifications or updates to the application registration from AuditLogs.",
            "2. The final `ObjectId` is 47dee0a2-d662-4664-acfa-a28bb62bdbc0, which corresponds to the client application ID we are investigating.",
            "3. Find this `ClientAppId` in SecurityExposureManagement.",
            "4. The `ClientAppId` is bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "5. Check the AADServicePrincipalSignInLogs for the last authentication of this `ClientAppId`.",
            "6. The IP address for that authentication is 72.43.121.34.",
            "7. From SigninLogs, identify multiple failed authentication attempts and one successful attempt from this IP address.",
            "8. The email address that successfully authenticated is mvelazco@defenderatevet17.onmicrosoft.com."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs",
            "SigninLogs"
        ],
        "start_node": "12",
        "end_node": "10",
        "hop": "4"
    },
    {
        "difficulty": "Medium",
        "context": "ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "question": "what is the IP address involved in the authentication associated with this object ID?",
        "answer": "72.43.121.34",
        "solution": [
            "1. The `ObjectId` corresponds to the client application ID we are investigating.",
            "2. Find this `ClientAppId` in SecurityExposureManagement.",
            "3. The `ClientAppId` is bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "4. Check the AADServicePrincipalSignInLogs for the last authentication of this `ClientAppId`.",
            "5. The IP address for that authentication is 72.43.121.34."
        ],
        "tables": [
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": "6",
        "end_node": "8",
        "hop": "2"
    },
    {
        "difficulty": "Hard",
        "context": "ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "question": "what is the email address of the user that successfully authenticated after multiple failed attempts from the IP address associated with this object ID?",
        "answer": "mvelazco@defenderatevet17.onmicrosoft.com",
        "solution": [
            "1. The `ObjectId` corresponds to the client application ID we are investigating.",
            "2. Find this `ClientAppId` in SecurityExposureManagement.",
            "3. The `ClientAppId` is bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "4. Check the AADServicePrincipalSignInLogs for the last authentication of this `ClientAppId`.",
            "5. The IP address for that authentication is 72.43.121.34.",
            "6. From SigninLogs, identify multiple failed authentication attempts and one successful attempt from this IP address.",
            "7. The email address that successfully authenticated is mvelazco@defenderatevet17.onmicrosoft.com."
        ],
        "tables": [
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs",
            "SigninLogs"
        ],
        "start_node": "6",
        "end_node": "10",
        "hop": "3"
    },
    {
        "difficulty": "Hard",
        "context": "We learn that certain changes were made against the application. Specifically, new credentials were added to the application registration right before it authenticated.",
        "question": "What kind of suspicious activities were performed by the same IP address that made changes to the application?",
        "answer": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "solution": [
            "1. Check the audit logs to identify modifications to the application registration.",
            "2. Obtain the ObjectId related to the client app.",
            "3. Use the ObjectId to find more information about the client app from the SecurityExposureManagement table.",
            "4. Identify the ClientAppId associated with suspicious activities.",
            "5. Check for the latest authentication events from the AADServicePrincipalSignInLogs.",
            "6. Identify the IP address used for these authentication events.",
            "7. Investigate Microsoft Graph API requests from the same IP address."
        ],
        "tables": [
            "AuditLogs",
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": "12",
        "end_node": "14",
        "hop": "4"
    },
    {
        "difficulty": "Hard",
        "context": "ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "question": "What kind of suspicious activities were performed by the same IP address associated with ObjectId: 47dee0a2-d662-4664-acfa-a28bb62bdbc0?",
        "answer": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "solution": [
            "1. Use the ObjectId to find more information about the client app from the SecurityExposureManagement table.",
            "2. Identify the ClientAppId associated with suspicious activities.",
            "3. Check for the latest authentication events from the AADServicePrincipalSignInLogs.",
            "4. Identify the IP address used for these authentication events.",
            "5. Investigate Microsoft Graph API requests from the same IP address."
        ],
        "tables": [
            "SecurityExposureManagement",
            "AADServicePrincipalSignInLogs",
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": "6",
        "end_node": "14",
        "hop": "3"
    },
    {
        "difficulty": "Medium",
        "context": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "question": "What is the IP address of the user that is involved in the suspicious activity?",
        "answer": "72.43.121.34",
        "solution": [
            "1. The IP address used for multiple requests to the Microsoft Graph API is *found in the same IP activity* logs.",
            "The IP address is identified: 72.43.121.34."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs"
        ],
        "start_node": "14",
        "end_node": "8",
        "hop": "1"
    },
    {
        "difficulty": "Hard",
        "context": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "question": "What is the Client Application ID that authenticated from the suspicious IP address in use for Microsoft Graph API?",
        "answer": "bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
        "solution": [
            "1. The IP address used for multiple requests to the Microsoft Graph API is identified: 72.43.121.34.",
            "2. Using the `AADServicePrincipalSignInLogs`, the ClientAppId of the suspicious activity is found: bb77fe0b-52af-4f26-9bc7-19aa48854ebf."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "AADServicePrincipalSignInLogs"
        ],
        "start_node": "14",
        "end_node": "3",
        "hop": "2"
    },
    {
        "difficulty": "Hard",
        "context": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "question": "What is the suspicious activity involving email and performed through Graph API using an unknown application registration?",
        "answer": "Emails read with Graph API through a previously unknown application registration.",
        "solution": [
            "1. The IP address used for multiple requests to the Microsoft Graph API is identified: 72.43.121.34.",
            "2. Using the `AADServicePrincipalSignInLogs`, the ClientAppId of the suspicious activity is found: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. Check table `OfficeActivity` for activities involving mail reading: The suspicious activity is identified as an unknown application registration reading emails through Graph API."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": "14",
        "end_node": "1",
        "hop": "3"
    },
    {
        "difficulty": "Medium",
        "context": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "question": "What is the mailbox owner's UPN when accessing occurred from the IP address making requests to Microsoft Graph API for both users and applications?",
        "answer": "mmelendez@DefenderATEVET17.onmicrosoft.com",
        "solution": [
            "1. Identify the IP address making requests: 72.43.121.34.",
            "2. Review the authentication events for this IP address and identify the client application ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. Use the identified ClientAppId to query mail read events and find the relevant mailbox owner's UPN: mmelendez@DefenderATEVET17.onmicrosoft.com."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "AADServicePrincipalSignInLogs",
            "OfficeActivity"
        ],
        "start_node": "14",
        "end_node": "4",
        "hop": "3"
    },
    {
        "difficulty": "Medium",
        "context": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "question": "Which user successfully authenticated with the IP address making requests to both users and applications?",
        "answer": "mvelazco@defenderatevet17.onmicrosoft.com",
        "solution": [
            "1. Investigate activities associated with the same IP address making requests to the Microsoft Graph API for both users and applications.",
            "2. Identify the IP address: 72.43.121.34.",
            "3. Check SignIn logs for authentication events from the same IP address.",
            "4. Discover that multiple users are authenticating from the same IP address but failed. Identify the one account that successfully authenticated: mvelazco@defenderatevet17.onmicrosoft.com."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "SigninLogs"
        ],
        "start_node": "14",
        "end_node": "10",
        "hop": "3"
    },
    {
        "difficulty": "Medium",
        "context": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "question": "What is the ObjectId associated with the suspicious activity involving the IP address?",
        "answer": "47dee0a2-d662-4664-acfa-a28bb62bdbc0",
        "solution": [
            "1. The IP address involved is 72.43.121.34, which is making these suspicious requests.",
            "2. This activity is associated with a client application ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf",
            "3. Further investigation reveals more information about this client application ID, including the ObjectId."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement"
        ],
        "start_node": "14",
        "end_node": "6",
        "hop": "3"
    },
    {
        "difficulty": "Hard",
        "context": "The same IP address is making requests to the Microsoft Graph API for both users and applications.",
        "question": "What specific changes were made to the application registration that used the suspicious IP?",
        "answer": "New credentials were added to the application registration right before it authenticated.",
        "solution": [
            "1. The IP address involved is 72.43.121.34, which is making these suspicious requests.",
            "2. This activity is associated with a client application ID: bb77fe0b-52af-4f26-9bc7-19aa48854ebf.",
            "3. Further investigation reveals more information about this client application ID, including the ObjectId.",
            "4. Finally, checking the audit logs for modifications or updates right before the authentication leads to discovering that new credentials were added to the application registration."
        ],
        "tables": [
            "MicrosoftGraphActivityLogs",
            "AADServicePrincipalSignInLogs",
            "SecurityExposureManagement",
            "AuditLogs"
        ],
        "start_node": "14",
        "end_node": "12",
        "hop": "4"
    }
]